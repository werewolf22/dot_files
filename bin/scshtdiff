#!/usr/bin/php
<?php
require_once 'change-dir-bin.php';
require_once 'vendor/autoload.php';
use Carbon\Carbon;
$dateFormat = 'Y-m-d';
$datetimeFormat = $dateFormat.' H-i-s';
$date = $argv[1] ?? date($dateFormat);
$dirPath = '/home/werewolf/Pictures/Screenshots';
$files = scandir($dirPath);

// Filter out non-files and hidden files 
$files = array_filter($files, function($file) use ($dirPath) {
    return is_file("$dirPath/$file") && !in_array($file, ['.', '..']) && $file[0] !== '.';
});
$files = array_map(function ($file) {
	preg_match('/\d+-\d+-\d+ \d+-\d+-\d+/', $file, $match);
	return $match[0];
}, $files);
$filteredDates = array_filter($files, function($file) use ($date) {
	return preg_match("/$date/", $file);
});
print_r($filteredDates);
$comparisionDates = $filteredDates;
array_pop($comparisionDates);array_unshift($comparisionDates, $date.' 00-00-00');
$hoursdiffs = array_map(function($date, $date1) use ($datetimeFormat) {
	return Carbon::createFromFormat($datetimeFormat, $date)->diff(Carbon::createFromFormat($datetimeFormat, $date1))->format('%h hr %i min');
}, $filteredDates, $comparisionDates);
print_r($hoursdiffs);
